#!/bin/bash

. /common.sh

# Wait for the master to resolve (DNS-based)
if ! getent hosts spark-master; then
  echo "Waiting for spark-master to be resolvable..."
  sleep 5
  exit 0
fi

echo "Starting Spark Worker..."

# Launch the Spark Worker with web UI on 8081
/opt/spark/bin/spark-class org.apache.spark.deploy.worker.Worker spark://spark-master:7077 --webui-port 8081
